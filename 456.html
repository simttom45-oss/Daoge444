<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­™å¹´é£äº‘å½• - å¡ç‰‡é¢„è§ˆä¸å¯¼å‡ºå™¨</title>
    <!-- å¼•å…¥ html-to-image åº“ï¼Œç”¨äºå°†HTMLå…ƒç´ è½¬æ¢ä¸ºå›¾ç‰‡ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html-to-image/1.11.11/html-to-image.min.js"></script>
    <!-- å¼•å…¥ jszip åº“ï¼Œç”¨äºåˆ›å»ºå’Œä¸‹è½½ZIPå‹ç¼©æ–‡ä»¶ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- å¼•å…¥ lucide-icons å›¾æ ‡åº“ -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* --- CSSæ ·å¼ (V21.0 ä¸€é”®å¯¼å‡ºæœ€ç»ˆç‰ˆ) --- */
        /* å¼•å…¥é˜¿é‡Œå·´å·´æ™®æƒ ä½“ 2.0 - æ³¨æ„ï¼šç”±äºå­—ä½“è·¨åŸŸç­–ç•¥ï¼Œå¯¼å‡ºå›¾ç‰‡æ—¶å¯èƒ½æ— æ³•æ­£å¸¸æ˜¾ç¤ºï¼Œå®é™…éƒ¨ç½²æ—¶éœ€å¤„ç†å­—ä½“æ–‡ä»¶ã€‚*/
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700;900&display=swap');
        
        :root {
            --bg-color: #FFFFFF; 
            --text-color: #1a1a1a; 
            --secondary-text-color: #4a4a4a; 
            --light-text-color: #aaa; 
            --watermark-color: #EAEAEA;
            --font-family: 'Noto Sans SC', 'PingFang SC', 'Helvetica Neue', sans-serif;
            --accent-blue: #E9F3FB; 
            --accent-green: #EBF5EE; 
            --accent-pink: #FCEEEE; 
            --accent-purple: #f3e5f5; 
            --accent-yellow: #FFF9E5;
            --card-width: 1080px; 
            --card-height: 1440px;
        }
        body { 
            margin: 0; 
            padding: 0; 
            background-color: #f0f2f5; 
            font-family: var(--font-family); 
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .controls { 
            text-align: center; 
            padding: 40px; 
            background: #fff; 
            border-bottom: 1px solid #ddd; 
            position: sticky; 
            top: 0; 
            z-index: 1000; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .export-all-btn { 
            padding: 15px 30px; 
            font-size: 24px; 
            font-weight: 700; 
            background-color: #2c3e50; 
            color: #fff; 
            border: none; 
            border-radius: 10px; 
            cursor: pointer; 
            transition: all 0.3s ease;
        }
        .export-all-btn:hover { 
            background-color: #34495e; 
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .export-all-btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .all-cards-container { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            gap: 50px; 
            padding: 50px; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        .card-container { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 20px; 
        }
        .card {
            width: var(--card-width); 
            height: var(--card-height); 
            background-color: var(--bg-color); 
            color: var(--text-color);
            box-sizing: border-box; 
            padding: 100px; 
            display: flex; 
            flex-direction: column;
            position: relative; 
            flex-shrink: 0;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border-radius: 20px;
            overflow: hidden; /* ç¡®ä¿å†…å®¹ä¸ä¼šæº¢å‡ºåœ†è§’ */
        }
        .export-btn { 
            padding: 10px 20px; 
            font-size: 18px; 
            font-weight: 500; 
            background-color: #7f8c8d; 
            color: #fff; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            transition: all 0.3s ease;
        }
        .export-btn:hover { 
            background-color: #95a5a6;
            transform: translateY(-2px);
        }
        
        /* æ ¸å¿ƒç‰ˆå¼å†³ç­–ç±» */
        .layout-focal { justify-content: center; align-items: center; text-align: center; }
        .layout-focal .content-wrapper { width: 100%; max-width: 920px; text-align: center; }
        .layout-structured { justify-content: flex-start; align-items: center; text-align: left; }
        .layout-structured .content-wrapper { width: 100%; max-width: 880px; }

        /* å­—ä½“æ¸…æ™°åº¦ä¼˜åŒ–ä¸æ’ç‰ˆ */
        h1 { 
            font-size: 88px; 
            font-weight: 900; 
            margin: 0 0 40px 0; 
            line-height: 1.35; 
            text-shadow: 0 0 1px rgba(0,0,0,0.01); 
            letter-spacing: 2px;
        }
        .layout-structured h1 { font-size: 72px; }
        h2 { 
            font-size: 52px; 
            font-weight: 700; 
            margin: 20px 0; 
            display: inline-flex; 
            align-items: center; 
        }
        p { 
            font-size: 38px; 
            line-height: 1.8; 
            margin: 25px 0; 
            color: var(--secondary-text-color); 
            font-weight: 400; 
        }
        
        .main-icon { width: 80px; height: 80px; margin-bottom: 40px; color: var(--text-color); }
        .lucide-icon { stroke-width: 1.5; vertical-align: -0.15em; margin-right: 0.3em; width: 1.1em; height: 1.1em; }

        .footer { 
            position: absolute; 
            bottom: 60px; 
            left: 0; 
            right: 0; 
            text-align: center; 
            font-size: 30px; 
            color: var(--light-text-color); 
            font-weight: 400;
        }
        .watermark { 
            position: absolute; 
            bottom: 60px; 
            left: 100px; 
            font-size: 28px; 
            color: var(--watermark-color); 
            font-weight: 700;
        }
        .highlight {
            background: linear-gradient(120deg, var(--accent-yellow) 0%, #ffd8a8 100%);
            padding: 2px 10px;
            border-radius: 6px;
            font-weight: 700;
        }
    </style>
</head>
<body>
    <div class="controls">
        <button id="exportAll" class="export-all-btn">ğŸš€ ä¸€é”®å¯¼å‡ºå…¨éƒ¨å¡ç‰‡ä¸º ZIP</button>
    </div>
    <div class="all-cards-container">
        
        <!-- Card 1: å°é¢ -->
        <div class="card-container">
            <div class="card layout-focal" style="background-color: var(--accent-yellow);">
                <div class="content-wrapper">
                    <h1>ä»–è¢«éª‚10å¹´â€œå­™å‰²â€<br>å¦‚ä»Šå´è¦å°ç¥äº†ï¼Ÿ</h1>
                    <p>ä¸€ä¸ªåœ¨è§„åˆ™ç¼éš™é‡Œç–¯ç‹‚èˆåŠ¨çš„ç”·äººï¼Œ<br>ä¸€åœº<span class="highlight">å¤©æ‰çš„é€†è¢­</span>ï¼Œè¿˜æ˜¯<span class="highlight">éª—å±€çš„èƒœåˆ©</span>ï¼Ÿ</p>
                </div>
                <div class="watermark">SUN YUCHEN'S STORY</div>
                <div class="footer"><span class="page-number">1 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 1</button>
        </div>

        <!-- Card 2: é«˜è€ƒ -->
        <div class="card-container">
            <div class="card layout-structured">
                <div class="content-wrapper">
                    <h1>ğŸ“ ä»é«˜è€ƒâ€œé’»ç©ºå­â€ä¸ŠåŒ—å¤§</h1>
                    <p>å­™å®‡æ™¨çš„æ•…äº‹ï¼Œä»é«˜ä¸­å°±å……æ»¡â€œæŠ•æœºâ€è‰²å½©ã€‚ä»–å¹¶éåŸ‹å¤´è‹¦è¯»ï¼Œè€Œæ˜¯ç ”ç©¶é«˜è€ƒè§„åˆ™æ¼æ´ï¼Œé€šè¿‡æ–°æ¦‚å¿µä½œæ–‡å¤§èµ›ä¸€ç­‰å¥–çš„<span class="highlight">é™20åˆ†ç‰¹æƒ</span>ï¼Œå’Œç§»æ°‘é’æµ·çš„<span class="highlight">ä½åˆ†ä¼˜åŠ¿</span>ï¼ŒæˆåŠŸè¸å…¥åŒ—å¤§æ ¡é—¨ã€‚ğŸ¯</p>
                </div>
                <div class="watermark">THE BEGINNING</div>
                <div class="footer"><span class="page-number">2 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 2</button>
        </div>

        <!-- Card 3: å¤§å­¦ -->
        <div class="card-container">
            <div class="card layout-structured">
                <div class="content-wrapper">
                    <h1>ğŸ­ åŒ—å¤§å­¦éœ¸äººè®¾ç¿»è½¦ï¼Ÿ<br>ä»–å´æ‚Ÿå‡ºâ€œé»‘çº¢ä¹Ÿæ˜¯çº¢â€</h1>
                    <p>è¿›å…¥åŒ—å¤§ï¼Œä»–æ¨¡ä»¿éŸ©å¯’ï¼Œé€šè¿‡ç‹‚å–·æ¯æ ¡è¿…é€Ÿæˆä¸ºç½‘çº¢ã€‚åå› æŠ„è¢­äº‹ä»¶æƒ¨é­ç½‘æš´ï¼Œå´æ‚Ÿå‡ºç»ˆèº«å—ç”¨çš„é“ç†ï¼š<span class="highlight">â€œé»‘çº¢ä¹Ÿæ˜¯çº¢â€</span>ï¼Œè´Ÿé¢æµé‡ä¹Ÿæ˜¯æµé‡ã€‚ğŸ”¥</p>
                </div>
                <div class="watermark">THE EPIPHANY</div>
                <div class="footer"><span class="page-number">3 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 3</button>
        </div>

        <!-- Card 4: å­™å‰²ç”±æ¥ -->
        <div class="card-container">
            <div class="card layout-structured" style="background-color: var(--accent-pink);">
                <div class="content-wrapper">
                    <h1>ğŸ’¸ èèµ„6äº¿ç¾é‡‘å<br>ä»–è¿å¤œè·‘è·¯</h1>
                    <p>2017å¹´ï¼Œä»–ç²¾å‡†å¡ä½ï¼Œåœ¨å›½å®¶å«åœICOå‰ä¸€å¤©å®Œæˆå‘å¸ï¼Œèèµ„6äº¿ç¾é‡‘åå·æ¬¾è·‘è·¯ç¾å›½ã€‚åå°†æ³¢åœºå¸‚å€¼åšåˆ°æš´æ¶¨200å€ï¼Œä¾¿ç«‹åˆ»å¥—ç°120äº¿ç¦»åœºï¼Œæ— æ•°æŠ•èµ„è€…å€¾å®¶è¡äº§ã€‚â€œå­™å‰²â€åå·ä»æ­¤å«å“ã€‚ğŸ”ª</p>
                </div>
                <div class="watermark">"SUN THE RIPPER"</div>
                <div class="footer"><span class="page-number">4 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 4</button>
        </div>

        <!-- Card 5: æµé‡ä¹‹ç‹ -->
        <div class="card-container">
            <div class="card layout-structured">
                <div class="content-wrapper">
                    <h1>ğŸ‘‘ ç¥–ä¼ 100ä¸‡ä¸ä¸‰æˆå·´è²ç‰¹</h1>
                    <p>è·‘è·¯ç¾å›½åï¼Œä»–å¼€å§‹ç–¯ç‹‚â€œè¹­æµé‡â€ã€‚æ— è®ºæ˜¯ç‹æ€èªè¿˜æ˜¯OFOï¼Œä»–éƒ½å¸¦ç€â€œç¥–ä¼ çš„100ä¸‡â€å‡ºç°ï¼Œå®£ç§°è¦è¿˜å€ºï¼Œä½†ä»æœªå…‘ç°ã€‚æœ€ç»å…¸çš„æ˜¯<span class="highlight">ä¸‰æˆå·´è²ç‰¹</span>ï¼Œç”¨457ä¸‡ç¾é‡‘çš„åˆé¤ï¼Œè®©å…¨ä¸–ç•Œè®¤è¯†äº†ä»–å’Œæ³¢åœºã€‚ğŸ“ˆ</p>
                </div>
                <div class="watermark">KING OF HYPE</div>
                <div class="footer"><span class="page-number">5 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 5</button>
        </div>

        <!-- Card 6: é‡‘è‰è„±å£³ -->
        <div class="card-container">
            <div class="card layout-structured" style="background-color: var(--accent-green);">
                <div class="content-wrapper">
                    <h1>ğŸ›‚ å½“èµµé•¿é¹è¢«æŠ“<br>ä»–å¦‚ä½•ç”¨ä¸€æœ¬æŠ¤ç…§è§„é¿é£é™©ï¼Ÿ</h1>
                    <p>å½“è¢«ç¾å›½SECæŒ‡æ§å¹¶é€šç¼‰æ—¶ï¼Œä»–èŠ±è´¹100ä¸‡ç¾å…ƒå…¥ç±æ ¼æ—çº³è¾¾ï¼Œæ‘‡èº«ä¸€å˜æˆè¯¥å›½WTOå¤§ä½¿ã€‚è¿™ä¸ªèº«ä»½è®©ä»–è·å¾—<span class="highlight">å¤–äº¤è±å…æƒ</span>ï¼ŒæˆåŠŸä¸Šæ¼”â€œé‡‘è‰è„±å£³â€ã€‚ğŸ›¡ï¸</p>
                </div>
                <div class="watermark">THE GREAT ESCAPE</div>
                <div class="footer"><span class="page-number">6 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 6</button>
        </div>

        <!-- Card 7: æŠ¤åŸæ²³ -->
        <div class="card-container">
            <div class="card layout-structured">
                <div class="content-wrapper">
                    <h1>ğŸ¤ æ–¥èµ„7500ä¸‡ç¾é‡‘<br>æˆä¸ºç‰¹æœ—æ™®çš„â€œæ¦œä¸€å¤§å“¥â€</h1>
                    <p>ä¸ºå½»åº•æ‘†è„±é£é™©ï¼Œä»–æ–¥èµ„7500ä¸‡ç¾å…ƒï¼Œå¤§ä¸¾æŠ•èµ„ç‰¹æœ—æ™®ä»£å¸ï¼Œæˆä¸ºæœ€å¤§æŒæœ‰è€…ã€‚æœ€ç»ˆï¼Œä»–æˆäº†ç™½å®«åº§ä¸Šå®¾ï¼ŒSECçš„è°ƒæŸ¥ä¸äº†äº†ä¹‹ã€‚ä»–ç”¨èµ„æœ¬æ’¬åŠ¨æ”¿æ²»ï¼Œ<span class="highlight">å°†ç›‘ç®¡é£é™©åŒ–ä¸ºæŠ¤åŸæ²³</span>ã€‚ğŸ’¼</p>
                </div>
                <div class="watermark">THE MOAT</div>
                <div class="footer"><span class="page-number">7 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 7</button>
        </div>

        <!-- Card 8: çº³æ–¯è¾¾å…‹ -->
        <div class="card-container">
            <div class="card layout-structured" style="background-color: var(--accent-blue);">
                <div class="content-wrapper">
                    <h1>ğŸ”” æŠŠæ³¢åœºé€è¿›çº³æ–¯è¾¾å…‹</h1>
                    <p>è§£å†³ç›‘ç®¡é£é™©åï¼Œä»–æ”¶è´­ç¾è‚¡ä¸Šå¸‚å…¬å¸ï¼ŒæˆåŠŸå€Ÿå£³ä¸Šå¸‚ï¼Œå°†æ³¢åœºé€åˆ°çº³æ–¯è¾¾å…‹ã€‚ä»–æ­£å¼è¿›å…¥æ­£ç»Ÿé‡‘èå¸‚åœºï¼Œæ’¬å¼€äº†åå°”è¡—çš„è´¢å¯Œé˜€é—¨ã€‚ä¸Šå¸‚å½“æ—¥ï¼Œ<span class="highlight">èº«å®¶è¾¾åˆ°200äº¿ç¾å…ƒ</span>ã€‚ğŸ¦</p>
                </div>
                <div class="watermark">THE ENDGAME</div>
                <div class="footer"><span class="page-number">8 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 8</button>
        </div>

        <!-- Card 9: å¤ªç©º -->
        <div class="card-container">
            <div class="card layout-focal">
                <div class="content-wrapper">
                    <h1>ğŸš€ æŠŠæ³¢åœºLOGOå¸¦ä¸Šå¤ªç©º</h1>
                    <p>ä»–è±ªæ·2800ä¸‡ç¾å…ƒï¼Œæ­ä¹˜è“è‰²èµ·æºç«ç®­è¿›å…¥å¤ªç©ºã€‚å½“ä»–åœ¨å¤±é‡çŠ¶æ€ä¸‹å±•å¼€æ³¢åœºLOGOæ——å¸œæ—¶ï¼Œè¿™åœºæŒç»­10å¹´çš„æµé‡æ¸¸æˆï¼Œ<span class="highlight">è¾¾åˆ°äº†å¼•åŠ›ä¹‹å¤–çš„å·…å³°</span>ã€‚ğŸŒŒ</p>
                </div>
                <div class="watermark">THE COSMIC PR</div>
                <div class="footer"><span class="page-number">9 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 9</button>
        </div>
        
        <!-- Card 10: å£ç¢‘é€†è½¬ -->
        <div class="card-container">
            <div class="card layout-structured">
                <div class="content-wrapper">
                    <h1>ğŸ“œ â€œå¾…æˆ‘å…¥å…³æ—¶ï¼Œ<br>è‡ªæœ‰å¤§å„’ä¸ºæˆ‘è¾¨ç»â€</h1>
                    <p>å½“ä»–å®Œæˆä¸Šå¸‚ã€è¿›å…¥å¤ªç©ºã€èº«å®¶æš´æ¶¨åï¼Œå£ç¢‘å¼€å§‹é€†è½¬ã€‚æ›¾ç»çš„éª‚å£°ï¼Œé€æ¸è¢«â€œå¤©æ‰â€ã€â€œé‡å¿ƒå®¶â€çš„èµç¾å–ä»£ã€‚å½“ä¸€ä¸ªäººæˆåŠŸåˆ°æè‡´ï¼Œ<span class="highlight">å†å²ä¼¼ä¹éƒ½å¯ä»¥è¢«é‡æ–°è§£è¯»</span>ã€‚ğŸ¤”</p>
                </div>
                <div class="watermark">THE REVERSAL</div>
                <div class="footer"><span class="page-number">10 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 10</button>
        </div>

        <!-- Card 11: äº’åŠ¨ -->
        <div class="card-container">
            <div class="card layout-focal" style="background-color: #2c3e50; color: white;">
                <div class="content-wrapper">
                    <h1 style="color: white;">å¤©æ‰è¿˜æ˜¯éª—å­ï¼Ÿ</h1>
                    <p style="color: #bdc3c7;">è¿™ä¸ªåœ¨è§„åˆ™ç¼éš™é‡Œè·³èˆçš„ç”·äººï¼Œä½ æ€ä¹ˆçœ‹ï¼Ÿ<br>åœ¨è¯„è®ºåŒºèŠèŠä½ çš„çœ‹æ³• ğŸ‘‡</p>
                </div>
                <div class="watermark" style="color: #46627f;">JOIN THE DISCUSSION</div>
                <div class="footer" style="color: #7f8c8d;"><span class="page-number">11 / 11</span></div>
            </div>
            <button class="export-btn">å¯¼å‡ºå¡ç‰‡ 11</button>
        </div>

    </div>

    <script>
        // åœ¨DOMåŠ è½½å®Œæˆåæ‰§è¡Œè„šæœ¬
        document.addEventListener('DOMContentLoaded', function () {
            // æ¿€æ´»lucideå›¾æ ‡
            lucide.createIcons();

            // --- å•ä¸ªå¡ç‰‡å¯¼å‡ºåŠŸèƒ½ ---
            const exportButtons = document.querySelectorAll('.export-btn');
            exportButtons.forEach(button => {
                button.addEventListener('click', function () {
                    const cardNode = this.previousElementSibling; // è·å–æŒ‰é’®å‰çš„ .card å…ƒç´ 
                    const cardTitle = cardNode.querySelector('h1').textContent.substring(0, 20).trim(); // ä½¿ç”¨æ ‡é¢˜ä½œä¸ºæ–‡ä»¶åçš„ä¸€éƒ¨åˆ†
                    const pageNumberText = cardNode.querySelector('.page-number').textContent.replace('/', '-');
                    const fileName = `card-${pageNumberText}-${cardTitle}.png`;

                    // è°ƒç”¨ html-to-image åº“ç”ŸæˆPNG
                    htmlToImage.toPng(cardNode, { 
                        quality: 1, 
                        pixelRatio: 2, // ä½¿ç”¨2å€åƒç´ æ¯”ç‡ä»¥è·å¾—æ›´é«˜æ¸…çš„å›¾ç‰‡
                        // å°è¯•åµŒå…¥å­—ä½“æ ·å¼ï¼Œä½†è¿™åœ¨æŸäº›æµè§ˆå™¨å’ŒCDNé…ç½®ä¸‹å¯èƒ½å› CORSç­–ç•¥è€Œå¤±è´¥
                        fontEmbedCss: Array.from(document.styleSheets)
                                         .map(sheet => {
                                             try {
                                                 return Array.from(sheet.cssRules).map(rule => rule.cssText).join('');
                                             } catch (e) {
                                                 // å¿½ç•¥ç”±äºè·¨åŸŸé™åˆ¶æ— æ³•è®¿é—®çš„æ ·å¼è¡¨
                                                 console.warn('Cannot access stylesheet:', sheet.href);
                                                 return '';
                                             }
                                         }).join('')
                    })
                    .then(function (dataUrl) {
                        // åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„aæ ‡ç­¾æ¥è§¦å‘ä¸‹è½½
                        const link = document.createElement('a');
                        link.download = fileName;
                        link.href = dataUrl;
                        link.click();
                    })
                    .catch(function (error) {
                        console.error('å¯¼å‡ºå¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯:', error);
                        alert('æŠ±æ­‰ï¼Œå›¾ç‰‡å¯¼å‡ºå¤±è´¥ã€‚è¯·æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°è·å–æ›´å¤šä¿¡æ¯ã€‚');
                    });
                });
            });

            // --- å…¨éƒ¨å¯¼å‡ºä¸ºZIPåŠŸèƒ½ ---
            const exportAllButton = document.getElementById('exportAll');
            exportAllButton.addEventListener('click', async function() {
                this.textContent = 'â³ æ­£åœ¨å¯¼å‡ºï¼Œè¯·ç¨å€™... (0/11)';
                this.disabled = true;
                
                const zip = new JSZip();
                const cardNodes = document.querySelectorAll('.card');

                for (let i = 0; i < cardNodes.length; i++) {
                    const node = cardNodes[i];
                    const cardTitle = node.querySelector('h1').textContent.substring(0, 20).trim();
                    const pageNumberText = node.querySelector('.page-number').textContent.replace('/', '-');
                    const fileName = `card-${pageNumberText}-${cardTitle}.png`;
                    
                    // æ›´æ–°æŒ‰é’®æ–‡æœ¬ä»¥æ˜¾ç¤ºè¿›åº¦
                    this.textContent = `â³ æ­£åœ¨å¯¼å‡ºï¼Œè¯·ç¨å€™... (${i + 1}/${cardNodes.length})`;

                    try {
                        const dataUrl = await htmlToImage.toPng(node, { 
                            quality: 1, 
                            pixelRatio: 2,
                            fontEmbedCss: Array.from(document.styleSheets)
                                         .map(sheet => {
                                             try {
                                                 return Array.from(sheet.cssRules).map(rule => rule.cssText).join('');
                                             } catch (e) { return ''; }
                                         }).join('')
                        });
                        // ä»dataURLä¸­æå–base64æ•°æ®éƒ¨åˆ†
                        const base64Data = dataUrl.split(',')[1];
                        // å°†å›¾ç‰‡æ–‡ä»¶æ·»åŠ åˆ°ZIPä¸­
                        zip.file(fileName, base64Data, {base64: true});
                    } catch (error) {
                       console.error(`å¯¼å‡ºå¡ç‰‡ ${pageNumberText} å¤±è´¥:`, error);
                    }
                }

                // ç”ŸæˆZIPæ–‡ä»¶å¹¶è§¦å‘ä¸‹è½½
                zip.generateAsync({type:"blob"}).then((content) => {
                    const link = document.createElement('a');
                    link.download = "å­™å®‡æ™¨åå¹´é£äº‘å½•-å…¨éƒ¨å¡ç‰‡.zip";
                    link.href = URL.createObjectURL(content);
                    link.click();
                    
                    // æ¢å¤æŒ‰é’®çŠ¶æ€
                    this.textContent = 'ğŸš€ ä¸€é”®å¯¼å‡ºå…¨éƒ¨å¡ç‰‡ä¸º ZIP';
                    this.disabled = false;
                });
            });
        });
    </script>
</body>
</html>

